<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - ithi.info - test/TldCountTest.cpp</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">test</a> - TldCountTest.cpp<span style="font-size: 80%;"> (source / <a href="TldCountTest.cpp.func.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">ithi.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">177</td>
            <td class="headerCovTableEntry">189</td>
            <td class="headerCovTableEntryHi">93.7 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2018-06-28</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">9</td>
            <td class="headerCovTableEntry">9</td>
            <td class="headerCovTableEntryHi">100.0 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /*</a>
<span class="lineNum">       2 </span>            : * Author: Christian Huitema
<span class="lineNum">       3 </span>            : * Copyright (c) 2018, Private Octopus, Inc.
<span class="lineNum">       4 </span>            : * All rights reserved.
<span class="lineNum">       5 </span>            : *
<span class="lineNum">       6 </span>            : * Permission to use, copy, modify, and distribute this software for any
<span class="lineNum">       7 </span>            : * purpose with or without fee is hereby granted, provided that the above
<span class="lineNum">       8 </span>            : * copyright notice and this permission notice appear in all copies.
<span class="lineNum">       9 </span>            : *
<span class="lineNum">      10 </span>            : * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND
<span class="lineNum">      11 </span>            : * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
<span class="lineNum">      12 </span>            : * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
<span class="lineNum">      13 </span>            : * DISCLAIMED. IN NO EVENT SHALL Private Octopus, Inc. BE LIABLE FOR ANY
<span class="lineNum">      14 </span>            : * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
<span class="lineNum">      15 </span>            : * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
<span class="lineNum">      16 </span>            : * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
<span class="lineNum">      17 </span>            : * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
<span class="lineNum">      18 </span>            : * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
<span class="lineNum">      19 </span>            : * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
<span class="lineNum">      20 </span>            : */
<span class="lineNum">      21 </span>            : 
<span class="lineNum">      22 </span>            : #include &lt;stdlib.h&gt;
<span class="lineNum">      23 </span>            : #include &lt;string.h&gt;
<span class="lineNum">      24 </span>            : #include &lt;algorithm&gt;
<span class="lineNum">      25 </span>            : #include &lt;vector&gt;
<span class="lineNum">      26 </span>            : #include &quot;DnsStats.h&quot;
<span class="lineNum">      27 </span>            : #include &quot;TldCountTest.h&quot;
<span class="lineNum">      28 </span>            : 
<a name="29"><span class="lineNum">      29 </span>            : </a>
<span class="lineNum">      30 </span>            : 
<span class="lineNum">      31 </span><span class="lineCov">          2 : TldCountTest::TldCountTest()</span>
<span class="lineNum">      32 </span>            : {
<span class="lineNum">      33 </span><span class="lineCov">          2 : }</span>
<a name="34"><span class="lineNum">      34 </span>            : </a>
<span class="lineNum">      35 </span>            : 
<span class="lineNum">      36 </span><span class="lineCov">          4 : TldCountTest::~TldCountTest()</span>
<span class="lineNum">      37 </span>            : {
<span class="lineNum">      38 </span><span class="lineCov">          4 : }</span>
<span class="lineNum">      39 </span>            : 
<span class="lineNum">      40 </span>            : static char const * TargetNames[] = {
<span class="lineNum">      41 </span>            :     &quot;AAA&quot;, &quot;AARP&quot;, &quot;ABARTH&quot;, &quot;ABB&quot;, &quot;ABBOTT&quot;, &quot;ABBVIE&quot;, &quot;ABC&quot;, &quot;ABLE&quot;, &quot;ABOGADO&quot;,
<span class="lineNum">      42 </span>            :     &quot;ABUDHABI&quot;, &quot;AC&quot;, &quot;ACADEMY&quot;, &quot;ACCENTURE&quot;, &quot;ACCOUNTANT&quot;, &quot;ACCOUNTANTS&quot;, &quot;ACO&quot;,
<span class="lineNum">      43 </span>            :     &quot;ACTIVE&quot;, &quot;ACTOR&quot;, &quot;AD&quot;, &quot;ADAC&quot;, &quot;ADS&quot;, &quot;ADULT&quot;, &quot;AE&quot;, &quot;AEG&quot;, &quot;AERO&quot;, &quot;AETNA&quot;,
<span class="lineNum">      44 </span>            :     &quot;AF&quot;, &quot;AFAMILYCOMPANY&quot;, &quot;AFL&quot;, &quot;AFRICA&quot;, &quot;AG&quot;, &quot;AGAKHAN&quot;, &quot;AGENCY&quot;, &quot;AI&quot;,
<span class="lineNum">      45 </span>            :     &quot;AIG&quot;, &quot;AIGO&quot;, &quot;AIRBUS&quot;, &quot;AIRFORCE&quot;, &quot;AIRTEL&quot;, &quot;AKDN&quot;, &quot;AL&quot;, &quot;ALFAROMEO&quot;,
<span class="lineNum">      46 </span>            :     &quot;ALIBABA&quot;, &quot;ALIPAY&quot;, &quot;ALLFINANZ&quot;, &quot;ALLSTATE&quot;, &quot;ALLY&quot;, &quot;ALSACE&quot;, &quot;ALSTOM&quot;, &quot;AM&quot;,
<span class="lineNum">      47 </span>            :     &quot;AMERICANEXPRESS&quot;, &quot;AMERICANFAMILY&quot;, &quot;AMEX&quot;, &quot;AMFAM&quot;, &quot;AMICA&quot;, &quot;AMSTERDAM&quot;,
<span class="lineNum">      48 </span>            :     &quot;ANALYTICS&quot;, &quot;ANDROID&quot;, &quot;ANQUAN&quot;, &quot;ANZ&quot;, &quot;AO&quot;, &quot;AOL&quot;, &quot;APARTMENTS&quot;, &quot;APP&quot;,
<span class="lineNum">      49 </span>            :     &quot;APPLE&quot;, &quot;AQ&quot;, &quot;AQUARELLE&quot;, &quot;AR&quot;, &quot;ARAB&quot;, &quot;ARAMCO&quot;, &quot;ARCHI&quot;, &quot;ARMY&quot;, &quot;ARPA&quot;,
<span class="lineNum">      50 </span>            :     &quot;ART&quot;, &quot;ARTE&quot;, &quot;AS&quot;, &quot;ASDA&quot;, &quot;ASIA&quot;, &quot;ASSOCIATES&quot;, &quot;AT&quot;, &quot;ATHLETA&quot;, &quot;ATTORNEY&quot;,
<span class="lineNum">      51 </span>            :     &quot;AU&quot;, &quot;AUCTION&quot;, &quot;AUDI&quot;, &quot;AUDIBLE&quot;, &quot;AUDIO&quot;, &quot;AUSPOST&quot;, &quot;AUTHOR&quot;, &quot;AUTO&quot;, &quot;AUTOS&quot;,
<span class="lineNum">      52 </span>            :     &quot;AVIANCA&quot;, &quot;AW&quot;, &quot;AWS&quot;, &quot;AX&quot;, &quot;AXA&quot;, &quot;AZ&quot;, &quot;AZURE&quot;, &quot;BA&quot;, &quot;BABY&quot;, &quot;BAIDU&quot;, &quot;BANAMEX&quot;,
<span class="lineNum">      53 </span>            :     &quot;BANANAREPUBLIC&quot;, &quot;BAND&quot;, &quot;BANK&quot;, &quot;BAR&quot;, &quot;BARCELONA&quot;, &quot;BARCLAYCARD&quot;, &quot;BARCLAYS&quot;,
<span class="lineNum">      54 </span>            :     &quot;BAREFOOT&quot;, &quot;BARGAINS&quot;, &quot;BASEBALL&quot;, &quot;BASKETBALL&quot;, &quot;BAUHAUS&quot;, &quot;BAYERN&quot;, &quot;BB&quot;, &quot;BBC&quot;,
<span class="lineNum">      55 </span>            :     &quot;BBT&quot;, &quot;BBVA&quot;, &quot;BCG&quot;, &quot;BCN&quot;, &quot;BD&quot;, &quot;BE&quot;, &quot;BEATS&quot;, &quot;BEAUTY&quot;, &quot;BEER&quot;, &quot;BENTLEY&quot;, &quot;BERLIN&quot;,
<span class="lineNum">      56 </span>            :     &quot;BEST&quot;, &quot;BESTBUY&quot;, &quot;BET&quot;, &quot;BF&quot;, &quot;BG&quot;, &quot;BH&quot;, &quot;BHARTI&quot;, &quot;BI&quot;, &quot;BIBLE&quot;, &quot;BID&quot;, &quot;BIKE&quot;,
<span class="lineNum">      57 </span>            :     &quot;BING&quot;, &quot;BINGO&quot;, &quot;BIO&quot;, &quot;BIZ&quot;, &quot;BJ&quot;, &quot;BLACK&quot;, &quot;BLACKFRIDAY&quot;, &quot;BLANCO&quot;, &quot;BLOCKBUSTER&quot;,
<span class="lineNum">      58 </span>            :     &quot;BLOG&quot;, &quot;BLOOMBERG&quot;, &quot;BLUE&quot;, &quot;BM&quot;, &quot;BMS&quot;, &quot;BMW&quot;, &quot;BN&quot;, &quot;BNL&quot;, &quot;BNPPARIBAS&quot;, &quot;BO&quot;, &quot;BOATS&quot;,
<span class="lineNum">      59 </span>            :     &quot;BOEHRINGER&quot;, &quot;BOFA&quot;, &quot;BOM&quot;, &quot;BOND&quot;, &quot;BOO&quot;, &quot;BOOK&quot;, &quot;BOOKING&quot;, &quot;BOOTS&quot;, &quot;BOSCH&quot;, &quot;BOSTIK&quot;,
<span class="lineNum">      60 </span>            :     &quot;BOSTON&quot;, &quot;BOT&quot;, &quot;BOUTIQUE&quot;, &quot;BOX&quot;, &quot;BR&quot;, &quot;BRADESCO&quot;, &quot;BRIDGESTONE&quot;, &quot;BROADWAY&quot;, &quot;BROKER&quot;,
<span class="lineNum">      61 </span>            :     &quot;BROTHER&quot;, &quot;BRUSSELS&quot;, &quot;BS&quot;, &quot;BT&quot;, &quot;BUDAPEST&quot;, &quot;BUGATTI&quot;, &quot;BUILD&quot;, &quot;BUILDERS&quot;, &quot;BUSINESS&quot;,
<span class="lineNum">      62 </span>            :     &quot;BUY&quot;, &quot;BUZZ&quot;, &quot;BV&quot;, &quot;BW&quot;, &quot;BY&quot;, &quot;BZ&quot;, &quot;BZH&quot;, &quot;CA&quot;, &quot;CAB&quot;, &quot;CAFE&quot;, &quot;CAL&quot;, &quot;CALL&quot;,
<span class="lineNum">      63 </span>            :     &quot;CALVINKLEIN&quot;, &quot;CAM&quot;, &quot;CAMERA&quot;, &quot;CAMP&quot;, &quot;CANCERRESEARCH&quot;, &quot;CANON&quot;, &quot;CAPETOWN&quot;, &quot;CAPITAL&quot;,
<span class="lineNum">      64 </span>            :     &quot;CAPITALONE&quot;, &quot;CAR&quot;, &quot;CARAVAN&quot;, &quot;CARDS&quot;, &quot;CARE&quot;, &quot;CAREER&quot;, &quot;CAREERS&quot;, &quot;CARS&quot;, &quot;CARTIER&quot;,
<span class="lineNum">      65 </span>            :     &quot;CASA&quot;, &quot;CASE&quot;, &quot;CASEIH&quot;, &quot;CASH&quot;, &quot;CASINO&quot;, &quot;CAT&quot;, &quot;CATERING&quot;, &quot;CATHOLIC&quot;, &quot;CBA&quot;, &quot;CBN&quot;,
<span class="lineNum">      66 </span>            :     &quot;CBRE&quot;, &quot;CBS&quot;, &quot;CC&quot;, &quot;CD&quot;, &quot;CEB&quot;, &quot;CENTER&quot;, &quot;CEO&quot;, &quot;CERN&quot;, &quot;CF&quot;, &quot;CFA&quot;, &quot;CFD&quot;, &quot;CG&quot;, &quot;CH&quot;,
<span class="lineNum">      67 </span>            :     &quot;CHANEL&quot;, &quot;CHANNEL&quot;, &quot;CHASE&quot;, &quot;CHAT&quot;, &quot;CHEAP&quot;, &quot;CHINTAI&quot;, &quot;CHRISTMAS&quot;, &quot;CHROME&quot;, &quot;CHRYSLER&quot;,
<span class="lineNum">      68 </span>            :     &quot;CHURCH&quot;, &quot;CI&quot;, &quot;CIPRIANI&quot;, &quot;CIRCLE&quot;, &quot;CISCO&quot;, &quot;CITADEL&quot;, &quot;CITI&quot;, &quot;CITIC&quot;, &quot;CITY&quot;,
<span class="lineNum">      69 </span>            :     &quot;CITYEATS&quot;, &quot;CK&quot;, &quot;CL&quot;, &quot;CLAIMS&quot;, &quot;CLEANING&quot;, &quot;CLICK&quot;, &quot;CLINIC&quot;, &quot;CLINIQUE&quot;, &quot;CLOTHING&quot;,
<span class="lineNum">      70 </span>            :     &quot;CLOUD&quot;, &quot;CLUB&quot;, &quot;CLUBMED&quot;, &quot;CM&quot;, &quot;CN&quot;, &quot;CO&quot;, &quot;COACH&quot;, &quot;CODES&quot;, &quot;COFFEE&quot;, &quot;COLLEGE&quot;,
<span class="lineNum">      71 </span>            :     &quot;COLOGNE&quot;, &quot;COM&quot;, &quot;COMCAST&quot;, &quot;COMMBANK&quot;, &quot;COMMUNITY&quot;, &quot;COMPANY&quot;, &quot;COMPARE&quot;, &quot;COMPUTER&quot;,
<span class="lineNum">      72 </span>            :     &quot;COMSEC&quot;, &quot;CONDOS&quot;, &quot;CONSTRUCTION&quot;, &quot;CONSULTING&quot;, &quot;CONTACT&quot;, &quot;CONTRACTORS&quot;, &quot;COOKING&quot;,
<span class="lineNum">      73 </span>            :     &quot;COOKINGCHANNEL&quot;, &quot;COOL&quot;, &quot;COOP&quot;, &quot;CORSICA&quot;, &quot;COUNTRY&quot;, &quot;COUPON&quot;, &quot;COUPONS&quot;, &quot;COURSES&quot;,
<span class="lineNum">      74 </span>            :     &quot;CR&quot;, &quot;CREDIT&quot;, &quot;CREDITCARD&quot;, &quot;CREDITUNION&quot;, &quot;CRICKET&quot;, &quot;CROWN&quot;, &quot;CRS&quot;, &quot;CRUISE&quot;,
<span class="lineNum">      75 </span>            :     &quot;CRUISES&quot;, &quot;CSC&quot;, &quot;CU&quot;, &quot;CUISINELLA&quot;, &quot;CV&quot;, &quot;CW&quot;, &quot;CX&quot;, &quot;CY&quot;, &quot;CYMRU&quot;, &quot;CYOU&quot;, &quot;CZ&quot;,
<span class="lineNum">      76 </span>            :     &quot;DABUR&quot;, &quot;DAD&quot;, &quot;DANCE&quot;, &quot;DATA&quot;, &quot;DATE&quot;, &quot;DATING&quot;, &quot;DATSUN&quot;, &quot;DAY&quot;, &quot;DCLK&quot;, &quot;DDS&quot;, &quot;DE&quot;,
<span class="lineNum">      77 </span>            :     &quot;DEAL&quot;, &quot;DEALER&quot;, &quot;DEALS&quot;, &quot;DEGREE&quot;, &quot;DELIVERY&quot;, &quot;DELL&quot;, &quot;DELOITTE&quot;, &quot;DELTA&quot;, &quot;DEMOCRAT&quot;,
<span class="lineNum">      78 </span>            :     &quot;DENTAL&quot;, &quot;DENTIST&quot;, &quot;DESI&quot;, &quot;DESIGN&quot;, &quot;DEV&quot;, &quot;DHL&quot;, &quot;DIAMONDS&quot;, &quot;DIET&quot;, &quot;DIGITAL&quot;,
<span class="lineNum">      79 </span>            :     &quot;DIRECT&quot;, &quot;DIRECTORY&quot;, &quot;DISCOUNT&quot;, &quot;DISCOVER&quot;, &quot;DISH&quot;, &quot;DIY&quot;, &quot;DJ&quot;, &quot;DK&quot;, &quot;DM&quot;, &quot;DNP&quot;,
<span class="lineNum">      80 </span>            :     &quot;DO&quot;, &quot;DOCS&quot;, &quot;DOCTOR&quot;, &quot;DODGE&quot;, &quot;DOG&quot;, &quot;DOHA&quot;, &quot;DOMAINS&quot;, &quot;DOT&quot;, &quot;DOWNLOAD&quot;, &quot;DRIVE&quot;,
<span class="lineNum">      81 </span>            :     &quot;DTV&quot;, &quot;DUBAI&quot;, &quot;DUCK&quot;, &quot;DUNLOP&quot;, &quot;DUNS&quot;, &quot;DUPONT&quot;, &quot;DURBAN&quot;, &quot;DVAG&quot;, &quot;DVR&quot;, &quot;DZ&quot;,
<span class="lineNum">      82 </span>            :     &quot;EARTH&quot;, &quot;EAT&quot;, &quot;EC&quot;, &quot;ECO&quot;, &quot;EDEKA&quot;, &quot;EDU&quot;, &quot;EDUCATION&quot;, &quot;EE&quot;, &quot;EG&quot;, &quot;EMAIL&quot;, &quot;EMERCK&quot;,
<span class="lineNum">      83 </span>            :     &quot;ENERGY&quot;, &quot;ENGINEER&quot;, &quot;ENGINEERING&quot;, &quot;ENTERPRISES&quot;, &quot;EPOST&quot;, &quot;EPSON&quot;, &quot;EQUIPMENT&quot;, &quot;ER&quot;,
<span class="lineNum">      84 </span>            :     &quot;ERICSSON&quot;, &quot;ERNI&quot;, &quot;ES&quot;, &quot;ESQ&quot;, &quot;ESTATE&quot;, &quot;ESURANCE&quot;, &quot;ET&quot;, &quot;ETISALAT&quot;, &quot;EU&quot;,
<span class="lineNum">      85 </span>            :     &quot;EUROVISION&quot;, &quot;EUS&quot;, &quot;EVENTS&quot;, &quot;EVERBANK&quot;, &quot;EXCHANGE&quot;, &quot;EXPERT&quot;, &quot;EXPOSED&quot;, &quot;EXPRESS&quot;,
<span class="lineNum">      86 </span>            :     &quot;EXTRASPACE&quot;, &quot;FAGE&quot;, &quot;FAIL&quot;, &quot;FAIRWINDS&quot;, &quot;FAITH&quot;, &quot;FAMILY&quot;, &quot;FAN&quot;, &quot;FANS&quot;, &quot;FARM&quot;,
<span class="lineNum">      87 </span>            :     &quot;FARMERS&quot;, &quot;FASHION&quot;, &quot;FAST&quot;, &quot;FEDEX&quot;, &quot;FEEDBACK&quot;, &quot;FERRARI&quot;, &quot;FERRERO&quot;, &quot;FI&quot;, &quot;FIAT&quot;,
<span class="lineNum">      88 </span>            :     &quot;FIDELITY&quot;, &quot;FIDO&quot;, &quot;FILM&quot;, &quot;FINAL&quot;, &quot;FINANCE&quot;, &quot;FINANCIAL&quot;, &quot;FIRE&quot;, &quot;FIRESTONE&quot;,
<span class="lineNum">      89 </span>            :     &quot;FIRMDALE&quot;, &quot;FISH&quot;, &quot;FISHING&quot;, &quot;FIT&quot;, &quot;FITNESS&quot;, &quot;FJ&quot;, &quot;FK&quot;, &quot;FLICKR&quot;, &quot;FLIGHTS&quot;, &quot;FLIR&quot;,
<span class="lineNum">      90 </span>            :     &quot;FLORIST&quot;, &quot;FLOWERS&quot;, &quot;FLY&quot;, &quot;FM&quot;, &quot;FO&quot;, &quot;FOO&quot;, &quot;FOOD&quot;, &quot;FOODNETWORK&quot;, &quot;FOOTBALL&quot;, &quot;FORD&quot;,
<span class="lineNum">      91 </span>            :     &quot;FOREX&quot;, &quot;FORSALE&quot;, &quot;FORUM&quot;, &quot;FOUNDATION&quot;, &quot;FOX&quot;, &quot;FR&quot;, &quot;FREE&quot;, &quot;FRESENIUS&quot;, &quot;FRL&quot;,
<span class="lineNum">      92 </span>            :     &quot;FROGANS&quot;, &quot;FRONTDOOR&quot;, &quot;FRONTIER&quot;, &quot;FTR&quot;, &quot;FUJITSU&quot;, &quot;FUJIXEROX&quot;, &quot;FUN&quot;, &quot;FUND&quot;,
<span class="lineNum">      93 </span>            :     &quot;FURNITURE&quot;, &quot;FUTBOL&quot;, &quot;FYI&quot;, &quot;GA&quot;, &quot;GAL&quot;, &quot;GALLERY&quot;, &quot;GALLO&quot;, &quot;GALLUP&quot;, &quot;GAME&quot;, &quot;GAMES&quot;,
<span class="lineNum">      94 </span>            :     &quot;GAP&quot;, &quot;GARDEN&quot;, &quot;GB&quot;, &quot;GBIZ&quot;, &quot;GD&quot;, &quot;GDN&quot;, &quot;GE&quot;, &quot;GEA&quot;, &quot;GENT&quot;, &quot;GENTING&quot;, &quot;GEORGE&quot;,
<span class="lineNum">      95 </span>            :     &quot;GF&quot;, &quot;GG&quot;, &quot;GGEE&quot;, &quot;GH&quot;, &quot;GI&quot;, &quot;GIFT&quot;, &quot;GIFTS&quot;, &quot;GIVES&quot;, &quot;GIVING&quot;, &quot;GL&quot;, &quot;GLADE&quot;,
<span class="lineNum">      96 </span>            :     &quot;GLASS&quot;, &quot;GLE&quot;, &quot;GLOBAL&quot;, &quot;GLOBO&quot;, &quot;GM&quot;, &quot;GMAIL&quot;, &quot;GMBH&quot;, &quot;GMO&quot;, &quot;GMX&quot;, &quot;GN&quot;, &quot;GODADDY&quot;,
<span class="lineNum">      97 </span>            :     &quot;GOLD&quot;, &quot;GOLDPOINT&quot;, &quot;GOLF&quot;, &quot;GOO&quot;, &quot;GOODHANDS&quot;, &quot;GOODYEAR&quot;, &quot;GOOG&quot;, &quot;GOOGLE&quot;, &quot;GOP&quot;,
<span class="lineNum">      98 </span>            :     &quot;GOT&quot;, &quot;GOV&quot;, &quot;GP&quot;, &quot;GQ&quot;, &quot;GR&quot;, &quot;GRAINGER&quot;, &quot;GRAPHICS&quot;, &quot;GRATIS&quot;, &quot;GREEN&quot;, &quot;GRIPE&quot;,
<span class="lineNum">      99 </span>            :     &quot;GROCERY&quot;, &quot;GROUP&quot;, &quot;GS&quot;, &quot;GT&quot;, &quot;GU&quot;, &quot;GUARDIAN&quot;, &quot;GUCCI&quot;, &quot;GUGE&quot;, &quot;GUIDE&quot;, &quot;GUITARS&quot;,
<span class="lineNum">     100 </span>            :     &quot;GURU&quot;, &quot;GW&quot;, &quot;GY&quot;, &quot;HAIR&quot;, &quot;HAMBURG&quot;, &quot;HANGOUT&quot;, &quot;HAUS&quot;, &quot;HBO&quot;, &quot;HDFC&quot;, &quot;HDFCBANK&quot;,
<span class="lineNum">     101 </span>            :     &quot;HEALTH&quot;, &quot;HEALTHCARE&quot;, &quot;HELP&quot;, &quot;HELSINKI&quot;, &quot;HERE&quot;, &quot;HERMES&quot;, &quot;HGTV&quot;, &quot;HIPHOP&quot;,
<span class="lineNum">     102 </span>            :     &quot;HISAMITSU&quot;, &quot;HITACHI&quot;, &quot;HIV&quot;, &quot;HK&quot;, &quot;HKT&quot;, &quot;HM&quot;, &quot;HN&quot;, &quot;HOCKEY&quot;, &quot;HOLDINGS&quot;, &quot;HOLIDAY&quot;,
<span class="lineNum">     103 </span>            :     &quot;HOMEDEPOT&quot;, &quot;HOMEGOODS&quot;, &quot;HOMES&quot;, &quot;HOMESENSE&quot;, &quot;HONDA&quot;, &quot;HONEYWELL&quot;, &quot;HORSE&quot;,
<span class="lineNum">     104 </span>            :     &quot;HOSPITAL&quot;, &quot;HOST&quot;, &quot;HOSTING&quot;, &quot;HOT&quot;, &quot;HOTELES&quot;, &quot;HOTELS&quot;, &quot;HOTMAIL&quot;, &quot;HOUSE&quot;, &quot;HOW&quot;,
<span class="lineNum">     105 </span>            :     &quot;HR&quot;, &quot;HSBC&quot;, &quot;HT&quot;, &quot;HTC&quot;, &quot;HU&quot;, &quot;HUGHES&quot;, &quot;HYATT&quot;, &quot;HYUNDAI&quot;, &quot;IBM&quot;, &quot;ICBC&quot;, &quot;ICE&quot;,
<span class="lineNum">     106 </span>            :     &quot;ICU&quot;, &quot;ID&quot;, &quot;IE&quot;, &quot;IEEE&quot;, &quot;IFM&quot;, &quot;IKANO&quot;, &quot;IL&quot;, &quot;IM&quot;, &quot;IMAMAT&quot;, &quot;IMDB&quot;, &quot;IMMO&quot;,
<span class="lineNum">     107 </span>            :     &quot;IMMOBILIEN&quot;, &quot;IN&quot;, &quot;INDUSTRIES&quot;, &quot;INFINITI&quot;, &quot;INFO&quot;, &quot;ING&quot;, &quot;INK&quot;, &quot;INSTITUTE&quot;,
<span class="lineNum">     108 </span>            :     &quot;INSURANCE&quot;, &quot;INSURE&quot;, &quot;INT&quot;, &quot;INTEL&quot;, &quot;INTERNATIONAL&quot;, &quot;INTUIT&quot;, &quot;INVESTMENTS&quot;, &quot;IO&quot;,
<span class="lineNum">     109 </span>            :     &quot;IPIRANGA&quot;, &quot;IQ&quot;, &quot;IR&quot;, &quot;IRISH&quot;, &quot;IS&quot;, &quot;ISELECT&quot;, &quot;ISMAILI&quot;, &quot;IST&quot;, &quot;ISTANBUL&quot;, &quot;IT&quot;,
<span class="lineNum">     110 </span>            :     &quot;ITAU&quot;, &quot;ITV&quot;, &quot;IVECO&quot;, &quot;IWC&quot;, &quot;JAGUAR&quot;, &quot;JAVA&quot;, &quot;JCB&quot;, &quot;JCP&quot;, &quot;JE&quot;, &quot;JEEP&quot;, &quot;JETZT&quot;,
<span class="lineNum">     111 </span>            :     &quot;JEWELRY&quot;, &quot;JIO&quot;, &quot;JLC&quot;, &quot;JLL&quot;, &quot;JM&quot;, &quot;JMP&quot;, &quot;JNJ&quot;, &quot;JO&quot;, &quot;JOBS&quot;, &quot;JOBURG&quot;, &quot;JOT&quot;, &quot;JOY&quot;,
<span class="lineNum">     112 </span>            :     &quot;JP&quot;, &quot;JPMORGAN&quot;, &quot;JPRS&quot;, &quot;JUEGOS&quot;, &quot;JUNIPER&quot;, &quot;KAUFEN&quot;, &quot;KDDI&quot;, &quot;KE&quot;, &quot;KERRYHOTELS&quot;,
<span class="lineNum">     113 </span>            :     &quot;KERRYLOGISTICS&quot;, &quot;KERRYPROPERTIES&quot;, &quot;KFH&quot;, &quot;KG&quot;, &quot;KH&quot;, &quot;KI&quot;, &quot;KIA&quot;, &quot;KIM&quot;, &quot;KINDER&quot;,
<span class="lineNum">     114 </span>            :     &quot;KINDLE&quot;, &quot;KITCHEN&quot;, &quot;KIWI&quot;, &quot;KM&quot;, &quot;KN&quot;, &quot;KOELN&quot;, &quot;KOMATSU&quot;, &quot;KOSHER&quot;, &quot;KP&quot;, &quot;KPMG&quot;,
<span class="lineNum">     115 </span>            :     &quot;KPN&quot;, &quot;KR&quot;, &quot;KRD&quot;, &quot;KRED&quot;, &quot;KUOKGROUP&quot;, &quot;KW&quot;, &quot;KY&quot;, &quot;KYOTO&quot;, &quot;KZ&quot;, &quot;LA&quot;, &quot;LACAIXA&quot;,
<span class="lineNum">     116 </span>            :     &quot;LADBROKES&quot;, &quot;LAMBORGHINI&quot;, &quot;LAMER&quot;, &quot;LANCASTER&quot;, &quot;LANCIA&quot;, &quot;LANCOME&quot;, &quot;LAND&quot;,
<span class="lineNum">     117 </span>            :     &quot;LANDROVER&quot;, &quot;LANXESS&quot;, &quot;LASALLE&quot;, &quot;LAT&quot;, &quot;LATINO&quot;, &quot;LATROBE&quot;, &quot;LAW&quot;, &quot;LAWYER&quot;, &quot;LB&quot;,
<span class="lineNum">     118 </span>            :     &quot;LC&quot;, &quot;LDS&quot;, &quot;LEASE&quot;, &quot;LECLERC&quot;, &quot;LEFRAK&quot;, &quot;LEGAL&quot;, &quot;LEGO&quot;, &quot;LEXUS&quot;, &quot;LGBT&quot;, &quot;LI&quot;,
<span class="lineNum">     119 </span>            :     &quot;LIAISON&quot;, &quot;LIDL&quot;, &quot;LIFE&quot;, &quot;LIFEINSURANCE&quot;, &quot;LIFESTYLE&quot;, &quot;LIGHTING&quot;, &quot;LIKE&quot;, &quot;LILLY&quot;,
<span class="lineNum">     120 </span>            :     &quot;LIMITED&quot;, &quot;LIMO&quot;, &quot;LINCOLN&quot;, &quot;LINDE&quot;, &quot;LINK&quot;, &quot;LIPSY&quot;, &quot;LIVE&quot;, &quot;LIVING&quot;, &quot;LIXIL&quot;, &quot;LK&quot;,
<span class="lineNum">     121 </span>            :     &quot;LOAN&quot;, &quot;LOANS&quot;, &quot;LOCKER&quot;, &quot;LOCUS&quot;, &quot;LOFT&quot;, &quot;LOL&quot;, &quot;LONDON&quot;, &quot;LOTTE&quot;, &quot;LOTTO&quot;, &quot;LOVE&quot;,
<span class="lineNum">     122 </span>            :     &quot;LPL&quot;, &quot;LPLFINANCIAL&quot;, &quot;LR&quot;, &quot;LS&quot;, &quot;LT&quot;, &quot;LTD&quot;, &quot;LTDA&quot;, &quot;LU&quot;, &quot;LUNDBECK&quot;, &quot;LUPIN&quot;,
<span class="lineNum">     123 </span>            :     &quot;LUXE&quot;, &quot;LUXURY&quot;, &quot;LV&quot;, &quot;LY&quot;, &quot;MA&quot;, &quot;MACYS&quot;, &quot;MADRID&quot;, &quot;MAIF&quot;, &quot;MAISON&quot;, &quot;MAKEUP&quot;, &quot;MAN&quot;,
<span class="lineNum">     124 </span>            :     &quot;MANAGEMENT&quot;, &quot;MANGO&quot;, &quot;MAP&quot;, &quot;MARKET&quot;, &quot;MARKETING&quot;, &quot;MARKETS&quot;, &quot;MARRIOTT&quot;, &quot;MARSHALLS&quot;,
<span class="lineNum">     125 </span>            :     &quot;MASERATI&quot;, &quot;MATTEL&quot;, &quot;MBA&quot;, &quot;MC&quot;, &quot;MCKINSEY&quot;, &quot;MD&quot;, &quot;ME&quot;, &quot;MED&quot;, &quot;MEDIA&quot;, &quot;MEET&quot;,
<span class="lineNum">     126 </span>            :     &quot;MELBOURNE&quot;, &quot;MEME&quot;, &quot;MEMORIAL&quot;, &quot;MEN&quot;, &quot;MENU&quot;, &quot;MEO&quot;, &quot;MERCKMSD&quot;, &quot;METLIFE&quot;, &quot;MG&quot;, &quot;MH&quot;,
<span class="lineNum">     127 </span>            :     &quot;MIAMI&quot;, &quot;MICROSOFT&quot;, &quot;MIL&quot;, &quot;MINI&quot;, &quot;MINT&quot;, &quot;MIT&quot;, &quot;MITSUBISHI&quot;, &quot;MK&quot;, &quot;ML&quot;, &quot;MLB&quot;,
<span class="lineNum">     128 </span>            :     &quot;MLS&quot;, &quot;MM&quot;, &quot;MMA&quot;, &quot;MN&quot;, &quot;MO&quot;, &quot;MOBI&quot;, &quot;MOBILE&quot;, &quot;MOBILY&quot;, &quot;MODA&quot;, &quot;MOE&quot;, &quot;MOI&quot;, &quot;MOM&quot;,
<span class="lineNum">     129 </span>            :     &quot;MONASH&quot;, &quot;MONEY&quot;, &quot;MONSTER&quot;, &quot;MOPAR&quot;, &quot;MORMON&quot;, &quot;MORTGAGE&quot;, &quot;MOSCOW&quot;, &quot;MOTO&quot;,
<span class="lineNum">     130 </span>            :     &quot;MOTORCYCLES&quot;, &quot;MOV&quot;, &quot;MOVIE&quot;, &quot;MOVISTAR&quot;, &quot;MP&quot;, &quot;MQ&quot;, &quot;MR&quot;, &quot;MS&quot;, &quot;MSD&quot;, &quot;MT&quot;, &quot;MTN&quot;,
<span class="lineNum">     131 </span>            :     &quot;MTR&quot;, &quot;MU&quot;, &quot;MUSEUM&quot;, &quot;MUTUAL&quot;, &quot;MV&quot;, &quot;MW&quot;, &quot;MX&quot;, &quot;MY&quot;, &quot;MZ&quot;, &quot;NA&quot;, &quot;NAB&quot;, &quot;NADEX&quot;,
<span class="lineNum">     132 </span>            :     &quot;NAGOYA&quot;, &quot;NAME&quot;, &quot;NATIONWIDE&quot;, &quot;NATURA&quot;, &quot;NAVY&quot;, &quot;NBA&quot;, &quot;NC&quot;, &quot;NE&quot;, &quot;NEC&quot;, &quot;NET&quot;,
<span class="lineNum">     133 </span>            :     &quot;NETBANK&quot;, &quot;NETFLIX&quot;, &quot;NETWORK&quot;, &quot;NEUSTAR&quot;, &quot;NEW&quot;, &quot;NEWHOLLAND&quot;, &quot;NEWS&quot;, &quot;NEXT&quot;,
<span class="lineNum">     134 </span>            :     &quot;NEXTDIRECT&quot;, &quot;NEXUS&quot;, &quot;NF&quot;, &quot;NFL&quot;, &quot;NG&quot;, &quot;NGO&quot;, &quot;NHK&quot;, &quot;NI&quot;, &quot;NICO&quot;, &quot;NIKE&quot;, &quot;NIKON&quot;,
<span class="lineNum">     135 </span>            :     &quot;NINJA&quot;, &quot;NISSAN&quot;, &quot;NISSAY&quot;, &quot;NL&quot;, &quot;NO&quot;, &quot;NOKIA&quot;, &quot;NORTHWESTERNMUTUAL&quot;, &quot;NORTON&quot;, &quot;NOW&quot;,
<span class="lineNum">     136 </span>            :     &quot;NOWRUZ&quot;, &quot;NOWTV&quot;, &quot;NP&quot;, &quot;NR&quot;, &quot;NRA&quot;, &quot;NRW&quot;, &quot;NTT&quot;, &quot;NU&quot;, &quot;NYC&quot;, &quot;NZ&quot;, &quot;OBI&quot;,
<span class="lineNum">     137 </span>            :     &quot;OBSERVER&quot;, &quot;OFF&quot;, &quot;OFFICE&quot;, &quot;OKINAWA&quot;, &quot;OLAYAN&quot;, &quot;OLAYANGROUP&quot;, &quot;OLDNAVY&quot;, &quot;OLLO&quot;,
<span class="lineNum">     138 </span>            :     &quot;OM&quot;, &quot;OMEGA&quot;, &quot;ONE&quot;, &quot;ONG&quot;, &quot;ONL&quot;, &quot;ONLINE&quot;, &quot;ONYOURSIDE&quot;, &quot;OOO&quot;, &quot;OPEN&quot;, &quot;ORACLE&quot;,
<span class="lineNum">     139 </span>            :     &quot;ORANGE&quot;, &quot;ORG&quot;, &quot;ORGANIC&quot;, &quot;ORIGINS&quot;, &quot;OSAKA&quot;, &quot;OTSUKA&quot;, &quot;OTT&quot;, &quot;OVH&quot;, &quot;PA&quot;, &quot;PAGE&quot;,
<span class="lineNum">     140 </span>            :     &quot;PANASONIC&quot;, &quot;PANERAI&quot;, &quot;PARIS&quot;, &quot;PARS&quot;, &quot;PARTNERS&quot;, &quot;PARTS&quot;, &quot;PARTY&quot;, &quot;PASSAGENS&quot;,
<span class="lineNum">     141 </span>            :     &quot;PAY&quot;, &quot;PCCW&quot;, &quot;PE&quot;, &quot;PET&quot;, &quot;PF&quot;, &quot;PFIZER&quot;, &quot;PG&quot;, &quot;PH&quot;, &quot;PHARMACY&quot;, &quot;PHD&quot;, &quot;PHILIPS&quot;,
<span class="lineNum">     142 </span>            :     &quot;PHONE&quot;, &quot;PHOTO&quot;, &quot;PHOTOGRAPHY&quot;, &quot;PHOTOS&quot;, &quot;PHYSIO&quot;, &quot;PIAGET&quot;, &quot;PICS&quot;, &quot;PICTET&quot;,
<span class="lineNum">     143 </span>            :     &quot;PICTURES&quot;, &quot;PID&quot;, &quot;PIN&quot;, &quot;PING&quot;, &quot;PINK&quot;, &quot;PIONEER&quot;, &quot;PIZZA&quot;, &quot;PK&quot;, &quot;PL&quot;, &quot;PLACE&quot;,
<span class="lineNum">     144 </span>            :     &quot;PLAY&quot;, &quot;PLAYSTATION&quot;, &quot;PLUMBING&quot;, &quot;PLUS&quot;, &quot;PM&quot;, &quot;PN&quot;, &quot;PNC&quot;, &quot;POHL&quot;, &quot;POKER&quot;, &quot;POLITIE&quot;,
<span class="lineNum">     145 </span>            :     &quot;PORN&quot;, &quot;POST&quot;, &quot;PR&quot;, &quot;PRAMERICA&quot;, &quot;PRAXI&quot;, &quot;PRESS&quot;, &quot;PRIME&quot;, &quot;PRO&quot;, &quot;PROD&quot;,
<span class="lineNum">     146 </span>            :     &quot;PRODUCTIONS&quot;, &quot;PROF&quot;, &quot;PROGRESSIVE&quot;, &quot;PROMO&quot;, &quot;PROPERTIES&quot;, &quot;PROPERTY&quot;, &quot;PROTECTION&quot;,
<span class="lineNum">     147 </span>            :     &quot;PRU&quot;, &quot;PRUDENTIAL&quot;, &quot;PS&quot;, &quot;PT&quot;, &quot;PUB&quot;, &quot;PW&quot;, &quot;PWC&quot;, &quot;PY&quot;, &quot;QA&quot;, &quot;QPON&quot;, &quot;QUEBEC&quot;,
<span class="lineNum">     148 </span>            :     &quot;QUEST&quot;, &quot;QVC&quot;, &quot;RACING&quot;, &quot;RADIO&quot;, &quot;RAID&quot;, &quot;RE&quot;, &quot;READ&quot;, &quot;REALESTATE&quot;, &quot;REALTOR&quot;,
<span class="lineNum">     149 </span>            :     &quot;REALTY&quot;, &quot;RECIPES&quot;, &quot;RED&quot;, &quot;REDSTONE&quot;, &quot;REDUMBRELLA&quot;, &quot;REHAB&quot;, &quot;REISE&quot;, &quot;REISEN&quot;,
<span class="lineNum">     150 </span>            :     &quot;REIT&quot;, &quot;RELIANCE&quot;, &quot;REN&quot;, &quot;RENT&quot;, &quot;RENTALS&quot;, &quot;REPAIR&quot;, &quot;REPORT&quot;, &quot;REPUBLICAN&quot;, &quot;REST&quot;,
<span class="lineNum">     151 </span>            :     &quot;RESTAURANT&quot;, &quot;REVIEW&quot;, &quot;REVIEWS&quot;, &quot;REXROTH&quot;, &quot;RICH&quot;, &quot;RICHARDLI&quot;, &quot;RICOH&quot;,
<span class="lineNum">     152 </span>            :     &quot;RIGHTATHOME&quot;, &quot;RIL&quot;, &quot;RIO&quot;, &quot;RIP&quot;, &quot;RMIT&quot;, &quot;RO&quot;, &quot;ROCHER&quot;, &quot;ROCKS&quot;, &quot;RODEO&quot;, &quot;ROGERS&quot;,
<span class="lineNum">     153 </span>            :     &quot;ROOM&quot;, &quot;RS&quot;, &quot;RSVP&quot;, &quot;RU&quot;, &quot;RUGBY&quot;, &quot;RUHR&quot;, &quot;RUN&quot;, &quot;RW&quot;, &quot;RWE&quot;, &quot;RYUKYU&quot;, &quot;SA&quot;,
<span class="lineNum">     154 </span>            :     &quot;SAARLAND&quot;, &quot;SAFE&quot;, &quot;SAFETY&quot;, &quot;SAKURA&quot;, &quot;SALE&quot;, &quot;SALON&quot;, &quot;SAMSCLUB&quot;, &quot;SAMSUNG&quot;,
<span class="lineNum">     155 </span>            :     &quot;SANDVIK&quot;, &quot;SANDVIKCOROMANT&quot;, &quot;SANOFI&quot;, &quot;SAP&quot;, &quot;SAPO&quot;, &quot;SARL&quot;, &quot;SAS&quot;, &quot;SAVE&quot;, &quot;SAXO&quot;,
<span class="lineNum">     156 </span>            :     &quot;SB&quot;, &quot;SBI&quot;, &quot;SBS&quot;, &quot;SC&quot;, &quot;SCA&quot;, &quot;SCB&quot;, &quot;SCHAEFFLER&quot;, &quot;SCHMIDT&quot;, &quot;SCHOLARSHIPS&quot;,
<span class="lineNum">     157 </span>            :     &quot;SCHOOL&quot;, &quot;SCHULE&quot;, &quot;SCHWARZ&quot;, &quot;SCIENCE&quot;, &quot;SCJOHNSON&quot;, &quot;SCOR&quot;, &quot;SCOT&quot;, &quot;SD&quot;, &quot;SE&quot;,
<span class="lineNum">     158 </span>            :     &quot;SEARCH&quot;, &quot;SEAT&quot;, &quot;SECURE&quot;, &quot;SECURITY&quot;, &quot;SEEK&quot;, &quot;SELECT&quot;, &quot;SENER&quot;, &quot;SERVICES&quot;, &quot;SES&quot;,
<span class="lineNum">     159 </span>            :     &quot;SEVEN&quot;, &quot;SEW&quot;, &quot;SEX&quot;, &quot;SEXY&quot;, &quot;SFR&quot;, &quot;SG&quot;, &quot;SH&quot;, &quot;SHANGRILA&quot;, &quot;SHARP&quot;, &quot;SHAW&quot;, &quot;SHELL&quot;,
<span class="lineNum">     160 </span>            :     &quot;SHIA&quot;, &quot;SHIKSHA&quot;, &quot;SHOES&quot;, &quot;SHOP&quot;, &quot;SHOPPING&quot;, &quot;SHOUJI&quot;, &quot;SHOW&quot;, &quot;SHOWTIME&quot;, &quot;SHRIRAM&quot;,
<span class="lineNum">     161 </span>            :     &quot;SI&quot;, &quot;SILK&quot;, &quot;SINA&quot;, &quot;SINGLES&quot;, &quot;SITE&quot;, &quot;SJ&quot;, &quot;SK&quot;, &quot;SKI&quot;, &quot;SKIN&quot;, &quot;SKY&quot;, &quot;SKYPE&quot;, &quot;SL&quot;,
<span class="lineNum">     162 </span>            :     &quot;SLING&quot;, &quot;SM&quot;, &quot;SMART&quot;, &quot;SMILE&quot;, &quot;SN&quot;, &quot;SNCF&quot;, &quot;SO&quot;, &quot;SOCCER&quot;, &quot;SOCIAL&quot;, &quot;SOFTBANK&quot;,
<span class="lineNum">     163 </span>            :     &quot;SOFTWARE&quot;, &quot;SOHU&quot;, &quot;SOLAR&quot;, &quot;SOLUTIONS&quot;, &quot;SONG&quot;, &quot;SONY&quot;, &quot;SOY&quot;, &quot;SPACE&quot;, &quot;SPIEGEL&quot;,
<span class="lineNum">     164 </span>            :     &quot;SPOT&quot;, &quot;SPREADBETTING&quot;, &quot;SR&quot;, &quot;SRL&quot;, &quot;SRT&quot;, &quot;ST&quot;, &quot;STADA&quot;, &quot;STAPLES&quot;, &quot;STAR&quot;, &quot;STARHUB&quot;,
<span class="lineNum">     165 </span>            :     &quot;STATEBANK&quot;, &quot;STATEFARM&quot;, &quot;STATOIL&quot;, &quot;STC&quot;, &quot;STCGROUP&quot;, &quot;STOCKHOLM&quot;, &quot;STORAGE&quot;, &quot;STORE&quot;,
<span class="lineNum">     166 </span>            :     &quot;STREAM&quot;, &quot;STUDIO&quot;, &quot;STUDY&quot;, &quot;STYLE&quot;, &quot;SU&quot;, &quot;SUCKS&quot;, &quot;SUPPLIES&quot;, &quot;SUPPLY&quot;, &quot;SUPPORT&quot;,
<span class="lineNum">     167 </span>            :     &quot;SURF&quot;, &quot;SURGERY&quot;, &quot;SUZUKI&quot;, &quot;SV&quot;, &quot;SWATCH&quot;, &quot;SWIFTCOVER&quot;, &quot;SWISS&quot;, &quot;SX&quot;, &quot;SY&quot;, &quot;SYDNEY&quot;,
<span class="lineNum">     168 </span>            :     &quot;SYMANTEC&quot;, &quot;SYSTEMS&quot;, &quot;SZ&quot;, &quot;TAB&quot;, &quot;TAIPEI&quot;, &quot;TALK&quot;, &quot;TAOBAO&quot;, &quot;TARGET&quot;, &quot;TATAMOTORS&quot;,
<span class="lineNum">     169 </span>            :     &quot;TATAR&quot;, &quot;TATTOO&quot;, &quot;TAX&quot;, &quot;TAXI&quot;, &quot;TC&quot;, &quot;TCI&quot;, &quot;TD&quot;, &quot;TDK&quot;, &quot;TEAM&quot;, &quot;TECH&quot;, &quot;TECHNOLOGY&quot;,
<span class="lineNum">     170 </span>            :     &quot;TEL&quot;, &quot;TELECITY&quot;, &quot;TELEFONICA&quot;, &quot;TEMASEK&quot;, &quot;TENNIS&quot;, &quot;TEVA&quot;, &quot;TF&quot;, &quot;TG&quot;, &quot;TH&quot;, &quot;THD&quot;,
<span class="lineNum">     171 </span>            :     &quot;THEATER&quot;, &quot;THEATRE&quot;, &quot;TIAA&quot;, &quot;TICKETS&quot;, &quot;TIENDA&quot;, &quot;TIFFANY&quot;, &quot;TIPS&quot;, &quot;TIRES&quot;, &quot;TIROL&quot;,
<span class="lineNum">     172 </span>            :     &quot;TJ&quot;, &quot;TJMAXX&quot;, &quot;TJX&quot;, &quot;TK&quot;, &quot;TKMAXX&quot;, &quot;TL&quot;, &quot;TM&quot;, &quot;TMALL&quot;, &quot;TN&quot;, &quot;TO&quot;, &quot;TODAY&quot;, &quot;TOKYO&quot;,
<span class="lineNum">     173 </span>            :     &quot;TOOLS&quot;, &quot;TOP&quot;, &quot;TORAY&quot;, &quot;TOSHIBA&quot;, &quot;TOTAL&quot;, &quot;TOURS&quot;, &quot;TOWN&quot;, &quot;TOYOTA&quot;, &quot;TOYS&quot;, &quot;TR&quot;,
<span class="lineNum">     174 </span>            :     &quot;TRADE&quot;, &quot;TRADING&quot;, &quot;TRAINING&quot;, &quot;TRAVEL&quot;, &quot;TRAVELCHANNEL&quot;, &quot;TRAVELERS&quot;,
<span class="lineNum">     175 </span>            :     &quot;TRAVELERSINSURANCE&quot;, &quot;TRUST&quot;, &quot;TRV&quot;, &quot;TT&quot;, &quot;TUBE&quot;, &quot;TUI&quot;, &quot;TUNES&quot;, &quot;TUSHU&quot;, &quot;TV&quot;, &quot;TVS&quot;,
<span class="lineNum">     176 </span>            :     &quot;TW&quot;, &quot;TZ&quot;, &quot;UA&quot;, &quot;UBANK&quot;, &quot;UBS&quot;, &quot;UCONNECT&quot;, &quot;UG&quot;, &quot;UK&quot;, &quot;UNICOM&quot;, &quot;UNIVERSITY&quot;, &quot;UNO&quot;,
<span class="lineNum">     177 </span>            :     &quot;UOL&quot;, &quot;UPS&quot;, &quot;US&quot;, &quot;UY&quot;, &quot;UZ&quot;, &quot;VA&quot;, &quot;VACATIONS&quot;, &quot;VANA&quot;, &quot;VANGUARD&quot;, &quot;VC&quot;, &quot;VE&quot;,
<span class="lineNum">     178 </span>            :     &quot;VEGAS&quot;, &quot;VENTURES&quot;, &quot;VERISIGN&quot;, &quot;VERSICHERUNG&quot;, &quot;VET&quot;, &quot;VG&quot;, &quot;VI&quot;, &quot;VIAJES&quot;, &quot;VIDEO&quot;,
<span class="lineNum">     179 </span>            :     &quot;VIG&quot;, &quot;VIKING&quot;, &quot;VILLAS&quot;, &quot;VIN&quot;, &quot;VIP&quot;, &quot;VIRGIN&quot;, &quot;VISA&quot;, &quot;VISION&quot;, &quot;VISTA&quot;,
<span class="lineNum">     180 </span>            :     &quot;VISTAPRINT&quot;, &quot;VIVA&quot;, &quot;VIVO&quot;, &quot;VLAANDEREN&quot;, &quot;VN&quot;, &quot;VODKA&quot;, &quot;VOLKSWAGEN&quot;, &quot;VOLVO&quot;, &quot;VOTE&quot;,
<span class="lineNum">     181 </span>            :     &quot;VOTING&quot;, &quot;VOTO&quot;, &quot;VOYAGE&quot;, &quot;VU&quot;, &quot;VUELOS&quot;, &quot;WALES&quot;, &quot;WALMART&quot;, &quot;WALTER&quot;, &quot;WANG&quot;,
<span class="lineNum">     182 </span>            :     &quot;WANGGOU&quot;, &quot;WARMAN&quot;, &quot;WATCH&quot;, &quot;WATCHES&quot;, &quot;WEATHER&quot;, &quot;WEATHERCHANNEL&quot;, &quot;WEBCAM&quot;, &quot;WEBER&quot;,
<span class="lineNum">     183 </span>            :     &quot;WEBSITE&quot;, &quot;WED&quot;, &quot;WEDDING&quot;, &quot;WEIBO&quot;, &quot;WEIR&quot;, &quot;WF&quot;, &quot;WHOSWHO&quot;, &quot;WIEN&quot;, &quot;WIKI&quot;,
<span class="lineNum">     184 </span>            :     &quot;WILLIAMHILL&quot;, &quot;WIN&quot;, &quot;WINDOWS&quot;, &quot;WINE&quot;, &quot;WINNERS&quot;, &quot;WME&quot;, &quot;WOLTERSKLUWER&quot;, &quot;WOODSIDE&quot;,
<span class="lineNum">     185 </span>            :     &quot;WORK&quot;, &quot;WORKS&quot;, &quot;WORLD&quot;, &quot;WOW&quot;, &quot;WS&quot;, &quot;WTC&quot;, &quot;WTF&quot;, &quot;XBOX&quot;, &quot;XEROX&quot;, &quot;XFINITY&quot;,
<span class="lineNum">     186 </span>            :     &quot;XIHUAN&quot;, &quot;XIN&quot;, &quot;XN--11B4C3D&quot;, &quot;XN--1CK2E1B&quot;, &quot;XN--1QQW23A&quot;, &quot;XN--2SCRJ9C&quot;,
<span class="lineNum">     187 </span>            :     &quot;XN--30RR7Y&quot;, &quot;XN--3BST00M&quot;, &quot;XN--3DS443G&quot;, &quot;XN--3E0B707E&quot;, &quot;XN--3HCRJ9C&quot;,
<span class="lineNum">     188 </span>            :     &quot;XN--3OQ18VL8PN36A&quot;, &quot;XN--3PXU8K&quot;, &quot;XN--42C2D9A&quot;, &quot;XN--45BR5CYL&quot;, &quot;XN--45BRJ9C&quot;,
<span class="lineNum">     189 </span>            :     &quot;XN--45Q11C&quot;, &quot;XN--4GBRIM&quot;, &quot;XN--54B7FTA0CC&quot;, &quot;XN--55QW42G&quot;, &quot;XN--55QX5D&quot;,
<span class="lineNum">     190 </span>            :     &quot;XN--5SU34J936BGSG&quot;, &quot;XN--5TZM5G&quot;, &quot;XN--6FRZ82G&quot;, &quot;XN--6QQ986B3XL&quot;, &quot;XN--80ADXHKS&quot;,
<span class="lineNum">     191 </span>            :     &quot;XN--80AO21A&quot;, &quot;XN--80AQECDR1A&quot;, &quot;XN--80ASEHDB&quot;, &quot;XN--80ASWG&quot;, &quot;XN--8Y0A063A&quot;,
<span class="lineNum">     192 </span>            :     &quot;XN--90A3AC&quot;, &quot;XN--90AE&quot;, &quot;XN--90AIS&quot;, &quot;XN--9DBQ2A&quot;, &quot;XN--9ET52U&quot;, &quot;XN--9KRT00A&quot;,
<span class="lineNum">     193 </span>            :     &quot;XN--B4W605FERD&quot;, &quot;XN--BCK1B9A5DRE4C&quot;, &quot;XN--C1AVG&quot;, &quot;XN--C2BR7G&quot;, &quot;XN--CCK2B3B&quot;,
<span class="lineNum">     194 </span>            :     &quot;XN--CG4BKI&quot;, &quot;XN--CLCHC0EA0B2G2A9GCD&quot;, &quot;XN--CZR694B&quot;, &quot;XN--CZRS0T&quot;, &quot;XN--CZRU2D&quot;,
<span class="lineNum">     195 </span>            :     &quot;XN--D1ACJ3B&quot;, &quot;XN--D1ALF&quot;, &quot;XN--E1A4C&quot;, &quot;XN--ECKVDTC9D&quot;, &quot;XN--EFVY88H&quot;, &quot;XN--ESTV75G&quot;,
<span class="lineNum">     196 </span>            :     &quot;XN--FCT429K&quot;, &quot;XN--FHBEI&quot;, &quot;XN--FIQ228C5HS&quot;, &quot;XN--FIQ64B&quot;, &quot;XN--FIQS8S&quot;, &quot;XN--FIQZ9S&quot;,
<span class="lineNum">     197 </span>            :     &quot;XN--FJQ720A&quot;, &quot;XN--FLW351E&quot;, &quot;XN--FPCRJ9C3D&quot;, &quot;XN--FZC2C9E2C&quot;, &quot;XN--FZYS8D69UVGM&quot;,
<span class="lineNum">     198 </span>            :     &quot;XN--G2XX48C&quot;, &quot;XN--GCKR3F0F&quot;, &quot;XN--GECRJ9C&quot;, &quot;XN--GK3AT1E&quot;, &quot;XN--H2BREG3EVE&quot;,
<span class="lineNum">     199 </span>            :     &quot;XN--H2BRJ9C&quot;, &quot;XN--H2BRJ9C8C&quot;, &quot;XN--HXT814E&quot;, &quot;XN--I1B6B1A6A2E&quot;, &quot;XN--IMR513N&quot;,
<span class="lineNum">     200 </span>            :     &quot;XN--IO0A7I&quot;, &quot;XN--J1AEF&quot;, &quot;XN--J1AMH&quot;, &quot;XN--J6W193G&quot;, &quot;XN--JLQ61U9W7B&quot;, &quot;XN--JVR189M&quot;,
<span class="lineNum">     201 </span>            :     &quot;XN--KCRX77D1X4A&quot;, &quot;XN--KPRW13D&quot;, &quot;XN--KPRY57D&quot;, &quot;XN--KPU716F&quot;, &quot;XN--KPUT3I&quot;,
<span class="lineNum">     202 </span>            :     &quot;XN--L1ACC&quot;, &quot;XN--LGBBAT1AD8J&quot;, &quot;XN--MGB9AWBF&quot;, &quot;XN--MGBA3A3EJT&quot;, &quot;XN--MGBA3A4F16A&quot;,
<span class="lineNum">     203 </span>            :     &quot;XN--MGBA7C0BBN0A&quot;, &quot;XN--MGBAAKC7DVF&quot;, &quot;XN--MGBAAM7A8H&quot;, &quot;XN--MGBAB2BD&quot;,
<span class="lineNum">     204 </span>            :     &quot;XN--MGBAI9AZGQP6J&quot;, &quot;XN--MGBAYH7GPA&quot;, &quot;XN--MGBB9FBPOB&quot;, &quot;XN--MGBBH1A&quot;, &quot;XN--MGBBH1A71E&quot;,
<span class="lineNum">     205 </span>            :     &quot;XN--MGBC0A9AZCG&quot;, &quot;XN--MGBCA7DZDO&quot;, &quot;XN--MGBERP4A5D4AR&quot;, &quot;XN--MGBGU82A&quot;,
<span class="lineNum">     206 </span>            :     &quot;XN--MGBI4ECEXP&quot;, &quot;XN--MGBPL2FH&quot;, &quot;XN--MGBT3DHD&quot;, &quot;XN--MGBTX2B&quot;, &quot;XN--MGBX4CD0AB&quot;,
<span class="lineNum">     207 </span>            :     &quot;XN--MIX891F&quot;, &quot;XN--MK1BU44C&quot;, &quot;XN--MXTQ1M&quot;, &quot;XN--NGBC5AZD&quot;, &quot;XN--NGBE9E0A&quot;, &quot;XN--NGBRX&quot;,
<span class="lineNum">     208 </span>            :     &quot;XN--NODE&quot;, &quot;XN--NQV7F&quot;, &quot;XN--NQV7FS00EMA&quot;, &quot;XN--NYQY26A&quot;, &quot;XN--O3CW4H&quot;, &quot;XN--OGBPF8FL&quot;,
<span class="lineNum">     209 </span>            :     &quot;XN--P1ACF&quot;, &quot;XN--P1AI&quot;, &quot;XN--PBT977C&quot;, &quot;XN--PGBS0DH&quot;, &quot;XN--PSSY2U&quot;, &quot;XN--Q9JYB4C&quot;,
<span class="lineNum">     210 </span>            :     &quot;XN--QCKA1PMC&quot;, &quot;XN--QXAM&quot;, &quot;XN--RHQV96G&quot;, &quot;XN--ROVU88B&quot;, &quot;XN--RVC1E0AM3E&quot;,
<span class="lineNum">     211 </span>            :     &quot;XN--S9BRJ9C&quot;, &quot;XN--SES554G&quot;, &quot;XN--T60B56A&quot;, &quot;XN--TCKWE&quot;, &quot;XN--TIQ49XQYJ&quot;, &quot;XN--UNUP4Y&quot;,
<span class="lineNum">     212 </span>            :     &quot;XN--VERMGENSBERATER-CTB&quot;, &quot;XN--VERMGENSBERATUNG-PWB&quot;, &quot;XN--VHQUV&quot;, &quot;XN--VUQ861B&quot;,
<span class="lineNum">     213 </span>            :     &quot;XN--W4R85EL8FHU5DNRA&quot;, &quot;XN--W4RS40L&quot;, &quot;XN--WGBH1C&quot;, &quot;XN--WGBL6A&quot;, &quot;XN--XHQ521B&quot;,
<span class="lineNum">     214 </span>            :     &quot;XN--XKC2AL3HYE2A&quot;, &quot;XN--XKC2DL3A5EE0H&quot;, &quot;XN--Y9A3AQ&quot;, &quot;XN--YFRO4I67O&quot;, &quot;XN--YGBI2AMMX&quot;,
<span class="lineNum">     215 </span>            :     &quot;XN--ZFR164B&quot;, &quot;XPERIA&quot;, &quot;XXX&quot;, &quot;XYZ&quot;, &quot;YACHTS&quot;, &quot;YAHOO&quot;, &quot;YAMAXUN&quot;, &quot;YANDEX&quot;, &quot;YE&quot;,
<span class="lineNum">     216 </span>            :     &quot;YODOBASHI&quot;, &quot;YOGA&quot;, &quot;YOKOHAMA&quot;, &quot;YOU&quot;, &quot;YOUTUBE&quot;, &quot;YT&quot;, &quot;YUN&quot;, &quot;ZA&quot;, &quot;ZAPPOS&quot;, &quot;ZARA&quot;,
<span class="lineNum">     217 </span>            :     &quot;ZERO&quot;, &quot;ZIP&quot;, &quot;ZIPPO&quot;, &quot;ZM&quot;, &quot;ZONE&quot;, &quot;ZUERICH&quot;, &quot;ZW&quot;,
<span class="lineNum">     218 </span>            : };
<span class="lineNum">     219 </span>            : 
<span class="lineNum">     220 </span>            : static const size_t nbTargetNames = sizeof(TargetNames) / sizeof(char const *);
<span class="lineNum">     221 </span>            : 
<span class="lineNum">     222 </span>            : typedef struct st_tld_count_test_hash_input_t {
<span class="lineNum">     223 </span>            :     int registry_id;
<span class="lineNum">     224 </span>            :     int key_type;
<span class="lineNum">     225 </span>            :     char const * key_text;
<span class="lineNum">     226 </span>            :     int key_number;
<span class="lineNum">     227 </span>            :     int count;
<span class="lineNum">     228 </span>            : } tld_count_test_hash_input_t;
<span class="lineNum">     229 </span>            : 
<span class="lineNum">     230 </span>            : static tld_count_test_hash_input_t hash_input_table[] = {
<span class="lineNum">     231 </span>            :     {REGISTRY_DNS_CLASSES, 0, NULL, 1, 19282420},
<span class="lineNum">     232 </span>            :     { REGISTRY_DNS_CLASSES,0,NULL,3,38 },
<span class="lineNum">     233 </span>            :     { REGISTRY_DNSSEC_Algorithm_Numbers,0,NULL,5,83454 },
<span class="lineNum">     234 </span>            :     { REGISTRY_DNSSEC_Algorithm_Numbers,0,NULL,7,11587 },
<span class="lineNum">     235 </span>            :     { REGISTRY_DNSSEC_Algorithm_Numbers,0,NULL,8,359955 },
<span class="lineNum">     236 </span>            :     { REGISTRY_DNSSEC_Algorithm_Numbers,0,NULL,10,943 },
<span class="lineNum">     237 </span>            :     { REGISTRY_DNSSEC_Algorithm_Numbers,0,NULL,13,217 },
<span class="lineNum">     238 </span>            :     { REGISTRY_EDNS_Header_Flags,0,NULL,0,8632252 },
<span class="lineNum">     239 </span>            :     { REGISTRY_EDNS_Header_Flags,0,NULL,8,1 },
<span class="lineNum">     240 </span>            :     { REGISTRY_EDNS_Header_Flags,0,NULL,9,2 },
<span class="lineNum">     241 </span>            :     { REGISTRY_EDNS_OPT_CODE,0,NULL,3,1 },
<span class="lineNum">     242 </span>            :     { REGISTRY_EDNS_OPT_CODE,0,NULL,8,77504 },
<span class="lineNum">     243 </span>            :     { REGISTRY_EDNS_OPT_CODE,0,NULL,9,1 },
<span class="lineNum">     244 </span>            :     { REGISTRY_EDNS_OPT_CODE,0,NULL,10,129653 },
<span class="lineNum">     245 </span>            :     { REGISTRY_EDNS_OPT_CODE,0,NULL,100,2 },
<span class="lineNum">     246 </span>            :     { REGISTRY_EDNS_OPT_CODE,0,NULL,65001,80 },
<span class="lineNum">     247 </span>            :     { REGISTRY_EDNS_Version_number,0,NULL,0,8729785 },
<span class="lineNum">     248 </span>            :     { REGISTRY_EDNS_Version_number,0,NULL,1,2 },
<span class="lineNum">     249 </span>            :     { REGISTRY_DNS_Header_Flags,0,NULL,4,8433638 },
<span class="lineNum">     250 </span>            :     { REGISTRY_DNS_Header_Flags,0,NULL,5,15393 },
<span class="lineNum">     251 </span>            :     { REGISTRY_DNS_Header_Flags,0,NULL,6,4550902 },
<span class="lineNum">     252 </span>            :     { REGISTRY_DNS_LabelType,0,NULL,0,7352191 },
<span class="lineNum">     253 </span>            :     { REGISTRY_DNS_LabelType,0,NULL,192,16862187 },
<span class="lineNum">     254 </span>            :     { REGISTRY_DNS_OpCodes,0,NULL,0,17250000 },
<span class="lineNum">     255 </span>            :     { REGISTRY_DNS_RCODES,0,NULL,0,11802316 },
<span class="lineNum">     256 </span>            :     { REGISTRY_DNS_RCODES,0,NULL,1,1 },
<span class="lineNum">     257 </span>            :     { REGISTRY_DNS_RCODES,0,NULL,2,400287 },
<span class="lineNum">     258 </span>            :     { REGISTRY_DNS_RCODES,0,NULL,3,3560937 },
<span class="lineNum">     259 </span>            :     { REGISTRY_DNS_RCODES,0,NULL,5,1486457 },
<span class="lineNum">     260 </span>            :     { REGISTRY_DNS_RCODES,0,NULL,16,2 },
<span class="lineNum">     261 </span>            :     { REGISTRY_DNS_RFC6761_Usage,1,&quot;LOCAL&quot;,0,16 },
<span class="lineNum">     262 </span>            :     { REGISTRY_DNS_RRType,0,NULL,1,4382558 },
<span class="lineNum">     263 </span>            :     { REGISTRY_DNS_RRType,0,NULL,2,6487796 },
<span class="lineNum">     264 </span>            :     { REGISTRY_DNS_RRType,0,NULL,5,174867 },
<span class="lineNum">     265 </span>            :     { REGISTRY_DNS_RRType,0,NULL,6,4431681 },
<span class="lineNum">     266 </span>            :     { REGISTRY_DNS_RRType,0,NULL,12,456825 },
<span class="lineNum">     267 </span>            :     { REGISTRY_DNS_RRType,0,NULL,15,1583235 },
<span class="lineNum">     268 </span>            :     { REGISTRY_DNS_RRType,0,NULL,16,2321 },
<span class="lineNum">     269 </span>            :     { REGISTRY_DNS_RRType,0,NULL,28,1104162 },
<span class="lineNum">     270 </span>            :     { REGISTRY_DNS_RRType,0,NULL,41,4362255 },
<span class="lineNum">     271 </span>            :     { REGISTRY_DNS_RRType,0,NULL,43,12832 },
<span class="lineNum">     272 </span>            :     { REGISTRY_DNS_RRType,0,NULL,46,409021 },
<span class="lineNum">     273 </span>            :     { REGISTRY_DNS_RRType,0,NULL,47,175187 },
<span class="lineNum">     274 </span>            :     { REGISTRY_DNS_RRType,0,NULL,48,34303 },
<span class="lineNum">     275 </span>            :     { REGISTRY_DNS_RRType,0,NULL,50,27670 },
<span class="lineNum">     276 </span>            :     { REGISTRY_DNS_TLD_Usage_Count,0,NULL,1,8573279 },
<span class="lineNum">     277 </span>            :     { REGISTRY_DNS_UsefulQueries,0,NULL,0,19 },
<span class="lineNum">     278 </span>            :     { REGISTRY_DNS_UsefulQueries,0,NULL,1,8 },
<span class="lineNum">     279 </span>            :     { REGISTRY_DNS_error_flag,0,NULL,0,17249987 },
<span class="lineNum">     280 </span>            :     { REGISTRY_DNS_error_flag,0,NULL,256,1 },
<span class="lineNum">     281 </span>            :     { REGISTRY_DNS_error_flag,0,NULL,384,12 },
<span class="lineNum">     282 </span>            :     { REGISTRY_DNS_root_QR,0,NULL,0,0 }
<span class="lineNum">     283 </span>            : };
<span class="lineNum">     284 </span>            : 
<a name="285"><span class="lineNum">     285 </span>            : static const size_t nb_hash_input_table = sizeof(hash_input_table) / sizeof(tld_count_test_hash_input_t);</a>
<span class="lineNum">     286 </span>            : 
<span class="lineNum">     287 </span><span class="lineCov">          2 : static void fill_initial_table(BinHash&lt;DnsHashEntry&gt; * hashTable) {</span>
<span class="lineNum">     288 </span><span class="lineCov">        106 :     for (size_t i = 0; i &lt; nb_hash_input_table; i++) {</span>
<span class="lineNum">     289 </span><span class="lineCov">        104 :         DnsHashEntry key;</span>
<span class="lineNum">     290 </span><span class="lineCov">        104 :         bool stored = false;</span>
<span class="lineNum">     291 </span>            : 
<span class="lineNum">     292 </span><span class="lineCov">        104 :         key.count = hash_input_table[i].count;</span>
<span class="lineNum">     293 </span><span class="lineCov">        104 :         key.registry_id = hash_input_table[i].registry_id;</span>
<span class="lineNum">     294 </span><span class="lineCov">        104 :         if (hash_input_table[i].key_type == 0) {</span>
<span class="lineNum">     295 </span><span class="lineCov">        102 :             key.key_length = sizeof(uint32_t);</span>
<span class="lineNum">     296 </span><span class="lineCov">        102 :             key.key_type = 0; /* number */</span>
<span class="lineNum">     297 </span><span class="lineCov">        102 :             key.key_number = hash_input_table[i].key_number;</span>
<span class="lineNum">     298 </span>            :         } else {
<span class="lineNum">     299 </span><span class="lineCov">          2 :             key.key_length = strlen(hash_input_table[i].key_text);</span>
<span class="lineNum">     300 </span><span class="lineCov">          2 :             key.key_type = 1; /* string */</span>
<span class="lineNum">     301 </span><span class="lineCov">          2 :             memcpy(key.key_value, hash_input_table[i].key_text, key.key_length);</span>
<span class="lineNum">     302 </span><span class="lineCov">          2 :             key.key_value[key.key_length] = 0;</span>
<span class="lineNum">     303 </span>            :         }
<span class="lineNum">     304 </span>            : 
<span class="lineNum">     305 </span><span class="lineCov">        104 :         (void)hashTable-&gt;InsertOrAdd(&amp;key, true, &amp;stored);</span>
<span class="lineNum">     306 </span><span class="lineCov">        104 :     }</span>
<span class="lineNum">     307 </span><span class="lineCov">          2 : }</span>
<span class="lineNum">     308 </span>            : 
<span class="lineNum">     309 </span>            : 
<a name="310"><span class="lineNum">     310 </span>            : static uint32_t xorshift_state = 0xdeadbeef;</a>
<span class="lineNum">     311 </span>            : 
<span class="lineNum">     312 </span><span class="lineCov">   13790010 : static uint32_t xorshift32()</span>
<span class="lineNum">     313 </span>            : {
<span class="lineNum">     314 </span>            :     /* Algorithm &quot;xor&quot; from p. 4 of Marsaglia, &quot;Xorshift RNGs&quot; */
<span class="lineNum">     315 </span><span class="lineCov">   13790010 :     uint32_t x = xorshift_state;</span>
<span class="lineNum">     316 </span><span class="lineCov">   13790010 :     x ^= x &lt;&lt; 13;</span>
<span class="lineNum">     317 </span><span class="lineCov">   13790010 :     x ^= x &gt;&gt; 17;</span>
<span class="lineNum">     318 </span><span class="lineCov">   13790010 :     x ^= x &lt;&lt; 5;</span>
<span class="lineNum">     319 </span><span class="lineCov">   13790010 :     xorshift_state = x;</span>
<span class="lineNum">     320 </span><span class="lineCov">   13790010 :     return x;</span>
<a name="321"><span class="lineNum">     321 </span>            : }</a>
<span class="lineNum">     322 </span>            : 
<span class="lineNum">     323 </span><span class="lineCov">   13789982 : static uint32_t random_uniform(uint32_t range_max)</span>
<span class="lineNum">     324 </span>            : {
<span class="lineNum">     325 </span><span class="lineCov">   13789982 :     uint32_t delta = 0xFFFFFFFF % range_max;</span>
<span class="lineNum">     326 </span>            :     uint32_t rnd;
<span class="lineNum">     327 </span>            : 
<span class="lineNum">     328 </span><span class="lineCov">   13790010 :     do {</span>
<span class="lineNum">     329 </span><span class="lineCov">   13790010 :         rnd = xorshift32();</span>
<span class="lineNum">     330 </span>            :     } while (rnd &lt; delta);
<span class="lineNum">     331 </span>            : 
<span class="lineNum">     332 </span><span class="lineCov">   13789982 :     return rnd % range_max;</span>
<span class="lineNum">     333 </span>            : }
<span class="lineNum">     334 </span>            : 
<a name="335"><span class="lineNum">     335 </span>            : #define RANDOM_TLD_LENGTH 16</a>
<span class="lineNum">     336 </span>            : 
<span class="lineNum">     337 </span><span class="lineCov">     795576 : static char * random_tld(char n[RANDOM_TLD_LENGTH + 1])</span>
<span class="lineNum">     338 </span>            : {
<span class="lineNum">     339 </span><span class="lineCov">   13524792 :     for (int i = 0; i &lt; RANDOM_TLD_LENGTH; i++) {</span>
<span class="lineNum">     340 </span><span class="lineCov">   12729216 :         n[i] = 'A' + random_uniform(26);</span>
<span class="lineNum">     341 </span>            :     }
<span class="lineNum">     342 </span><span class="lineCov">     795576 :     n[RANDOM_TLD_LENGTH] = 0;</span>
<span class="lineNum">     343 </span>            : 
<span class="lineNum">     344 </span><span class="lineCov">     795576 :     return n;</span>
<a name="345"><span class="lineNum">     345 </span>            : }</a>
<span class="lineNum">     346 </span>            : 
<span class="lineNum">     347 </span><span class="lineCov">          2 : bool TldCountTest::DoTest()</span>
<span class="lineNum">     348 </span>            : {
<span class="lineNum">     349 </span><span class="lineCov">          2 :     LruHash&lt;TldAsKey&gt; tldStringUsage;</span>
<span class="lineNum">     350 </span><span class="lineCov">          4 :     BinHash&lt;DnsHashEntry&gt; hashTable;</span>
<span class="lineNum">     351 </span>            :     int count_per_string[nbTargetNames+1];
<span class="lineNum">     352 </span><span class="lineCov">          2 :     const int initial_count = 0x10000;</span>
<span class="lineNum">     353 </span><span class="lineCov">          2 :     const int max_hash_size = 0x8000;</span>
<span class="lineNum">     354 </span><span class="lineCov">          2 :     const int max_delta_count = 0x80;</span>
<span class="lineNum">     355 </span><span class="lineCov">          2 :     const int max_tld_leakage_count = 0x80;</span>
<span class="lineNum">     356 </span><span class="lineCov">          2 :     int current_count = initial_count;</span>
<span class="lineNum">     357 </span><span class="lineCov">          2 :     int total_keys = 0;</span>
<span class="lineNum">     358 </span><span class="lineCov">          2 :     int dropped_keys = 0;</span>
<span class="lineNum">     359 </span><span class="lineCov">          2 :     int kept_keys = 0;</span>
<span class="lineNum">     360 </span><span class="lineCov">          2 :     int expected_count = 0;</span>
<span class="lineNum">     361 </span><span class="lineCov">          2 :     int hashed_count = 0;</span>
<span class="lineNum">     362 </span><span class="lineCov">          2 :     int hashed_total = 0;</span>
<span class="lineNum">     363 </span><span class="lineCov">          2 :     bool ret = true;</span>
<span class="lineNum">     364 </span><span class="lineCov">          2 :     size_t * rand_table = NULL;</span>
<span class="lineNum">     365 </span>            : 
<span class="lineNum">     366 </span><span class="lineCov">          2 :     fill_initial_table(&amp;hashTable);</span>
<span class="lineNum">     367 </span>            : 
<span class="lineNum">     368 </span><span class="lineCov">       3086 :     for (size_t i = 1; i &lt;= nbTargetNames; i++) {</span>
<span class="lineNum">     369 </span><span class="lineCov">       3084 :         total_keys += current_count;</span>
<span class="lineNum">     370 </span><span class="lineCov">       3084 :         if (i &lt;= max_tld_leakage_count)</span>
<span class="lineNum">     371 </span>            :         {
<span class="lineNum">     372 </span><span class="lineCov">        256 :             expected_count += current_count;</span>
<span class="lineNum">     373 </span>            :         }
<span class="lineNum">     374 </span><span class="lineCov">       3084 :         count_per_string[i] = current_count;</span>
<span class="lineNum">     375 </span><span class="lineCov">       3084 :         if (current_count &gt;= 2) {</span>
<span class="lineNum">     376 </span><span class="lineCov">         32 :             current_count &gt;&gt;= 1;</span>
<span class="lineNum">     377 </span>            :         }
<span class="lineNum">     378 </span>            :     }
<span class="lineNum">     379 </span>            : 
<span class="lineNum">     380 </span><span class="lineCov">          2 :     count_per_string[0] = 3*total_keys;</span>
<span class="lineNum">     381 </span><span class="lineCov">          2 :     total_keys *= 4;</span>
<span class="lineNum">     382 </span>            : 
<span class="lineNum">     383 </span>            :     /* Simulate random arrivals */
<span class="lineNum">     384 </span><span class="lineCov">          2 :     rand_table = new size_t[total_keys];</span>
<span class="lineNum">     385 </span>            : 
<span class="lineNum">     386 </span><span class="lineCov">          2 :     if (rand_table == NULL) {</span>
<span class="lineNum">     387 </span><span class="lineNoCov">          0 :         ret = false;</span>
<span class="lineNum">     388 </span><span class="lineNoCov">          0 :         TEST_LOG(&quot;Tld count test, cannot allocate rand_table[%d]\n&quot;, total_keys);</span>
<span class="lineNum">     389 </span>            :     } else {
<span class="lineNum">     390 </span><span class="lineCov">          2 :         int table_rank = 0;</span>
<span class="lineNum">     391 </span>            :         /* Build a list of ID with desired size and repetition */
<span class="lineNum">     392 </span><span class="lineCov">       3088 :         for (size_t i = 0; i &lt;= nbTargetNames; i++) {</span>
<span class="lineNum">     393 </span><span class="lineCov">    1063854 :             for (int c = 0; c &lt; count_per_string[i] &amp;&amp; table_rank &lt; total_keys; c++) {</span>
<span class="lineNum">     394 </span><span class="lineCov">    1060768 :                 rand_table[table_rank++] = i;</span>
<span class="lineNum">     395 </span>            :             }
<span class="lineNum">     396 </span>            :         }
<span class="lineNum">     397 </span>            : 
<span class="lineNum">     398 </span>            :         /* Random shuffle of the list to simulate random arrivals */
<span class="lineNum">     399 </span><span class="lineCov">    1060768 :         for (int r = total_keys - 1; r &gt;= 1; r--) {</span>
<span class="lineNum">     400 </span><span class="lineCov">    1060766 :             int x = random_uniform((uint32_t)(r + 1));</span>
<span class="lineNum">     401 </span>            : 
<span class="lineNum">     402 </span><span class="lineCov">    1060766 :             if (x != r) {</span>
<span class="lineNum">     403 </span><span class="lineCov">    1060730 :                 size_t rtx = rand_table[x];</span>
<span class="lineNum">     404 </span><span class="lineCov">    1060730 :                 rand_table[x] = rand_table[r];</span>
<span class="lineNum">     405 </span><span class="lineCov">    1060730 :                 rand_table[r] = rtx;</span>
<span class="lineNum">     406 </span>            :             }
<span class="lineNum">     407 </span>            :         }
<span class="lineNum">     408 </span>            : 
<span class="lineNum">     409 </span>            :         /* Simulate insertion */
<span class="lineNum">     410 </span><span class="lineCov">    1060770 :         for (int i = 0; i &lt; total_keys; i++)</span>
<span class="lineNum">     411 </span>            :         {
<span class="lineNum">     412 </span><span class="lineCov">    1060768 :             bool stored = false;</span>
<span class="lineNum">     413 </span>            :             char rand_name[RANDOM_TLD_LENGTH + 1];
<span class="lineNum">     414 </span><span class="lineCov">    1060768 :             char const * tld = (rand_table[i] == 0)? random_tld(rand_name): TargetNames[rand_table[i]-1];</span>
<span class="lineNum">     415 </span><span class="lineCov">    1060768 :             TldAsKey key((uint8_t *)tld, strlen(tld));</span>
<span class="lineNum">     416 </span><span class="lineCov">    1060768 :             TldAsKey * inserted = NULL;</span>
<span class="lineNum">     417 </span><span class="lineCov">    2121536 :             DnsHashEntry counter_entry;</span>
<span class="lineNum">     418 </span>            : 
<span class="lineNum">     419 </span><span class="lineCov">    1060768 :             counter_entry.registry_id = REGISTRY_DNS_TLD_Usage_Count;</span>
<span class="lineNum">     420 </span><span class="lineCov">    1060768 :             counter_entry.key_type = 0;</span>
<span class="lineNum">     421 </span><span class="lineCov">    1060768 :             counter_entry.key_length = sizeof(uint32_t);</span>
<span class="lineNum">     422 </span><span class="lineCov">    1060768 :             counter_entry.key_number = 0;</span>
<span class="lineNum">     423 </span><span class="lineCov">    1060768 :             counter_entry.count = 1;</span>
<span class="lineNum">     424 </span>            : 
<span class="lineNum">     425 </span><span class="lineCov">    1060768 :             (void)hashTable.InsertOrAdd(&amp;counter_entry, true, &amp;stored);</span>
<span class="lineNum">     426 </span>            : 
<span class="lineNum">     427 </span><span class="lineCov">    1060768 :             if (tldStringUsage.GetCount() &gt;= max_hash_size)</span>
<span class="lineNum">     428 </span>            :             {
<span class="lineNum">     429 </span><span class="lineCov">     733154 :                 TldAsKey * removed = tldStringUsage.RemoveLRU();</span>
<span class="lineNum">     430 </span><span class="lineCov">     733154 :                 if (removed != NULL)</span>
<span class="lineNum">     431 </span>            :                 {
<span class="lineNum">     432 </span><span class="lineCov">     733154 :                     dropped_keys += removed-&gt;count;</span>
<span class="lineNum">     433 </span><span class="lineCov">     733154 :                     delete removed;</span>
<span class="lineNum">     434 </span>            :                 }
<span class="lineNum">     435 </span>            :             }
<span class="lineNum">     436 </span><span class="lineCov">    1060768 :             inserted = tldStringUsage.InsertOrAdd(&amp;key, true, &amp;stored);</span>
<span class="lineNum">     437 </span><span class="lineCov">    1060768 :             if (inserted != NULL &amp;&amp; rand_table[i] &gt; 0 &amp;&amp; (int)inserted-&gt;count &gt; count_per_string[rand_table[i]]) {</span>
<span class="lineNum">     438 </span>            :                 TEST_LOG(&quot;TLD %s, count %d instead of %d\n&quot;,
<span class="lineNum">     439 </span><span class="lineNoCov">          0 :                     TargetNames[rand_table[i] - 1], inserted-&gt;count, count_per_string[rand_table[i]]);</span>
<span class="lineNum">     440 </span>            :             }
<span class="lineNum">     441 </span><span class="lineCov">    1060768 :         }</span>
<span class="lineNum">     442 </span>            : 
<span class="lineNum">     443 </span>            :         /* Simulate extraction */
<span class="lineNum">     444 </span><span class="lineCov">          2 :         if (tldStringUsage.GetCount() &gt; 0) {</span>
<span class="lineNum">     445 </span>            :             TldAsKey *tld_entry;
<span class="lineNum">     446 </span><span class="lineCov">          2 :             std::vector&lt;TldAsKey *&gt; lines(tldStringUsage.GetCount());</span>
<span class="lineNum">     447 </span><span class="lineCov">          2 :             int vector_index = 0;</span>
<span class="lineNum">     448 </span><span class="lineCov">          2 :             uint32_t export_count = 0;</span>
<span class="lineNum">     449 </span>            : 
<span class="lineNum">     450 </span>            : 
<span class="lineNum">     451 </span><span class="lineCov">     262146 :             for (uint32_t i = 0; i &lt; tldStringUsage.GetSize(); i++)</span>
<span class="lineNum">     452 </span>            :             {
<span class="lineNum">     453 </span><span class="lineCov">     262144 :                 tld_entry = tldStringUsage.GetEntry(i);</span>
<span class="lineNum">     454 </span>            : 
<span class="lineNum">     455 </span><span class="lineCov">     589824 :                 while (tld_entry != NULL)</span>
<span class="lineNum">     456 </span>            :                 {
<span class="lineNum">     457 </span><span class="lineCov">      65536 :                     int tld_index = GetTldIndex(tld_entry-&gt;tld, tld_entry-&gt;tld_len);</span>
<span class="lineNum">     458 </span><span class="lineCov">      65536 :                     if (tld_index &gt;= 0) {</span>
<span class="lineNum">     459 </span><span class="lineCov">        336 :                         if (tld_index &lt; max_tld_leakage_count &amp;&amp;</span>
<span class="lineNum">     460 </span><span class="lineCov">         42 :                             count_per_string[tld_index + 1] != (int)tld_entry-&gt;count) {</span>
<span class="lineNum">     461 </span>            :                             TEST_LOG(&quot;TLD %s, count %d instead of %d\n&quot;,
<span class="lineNum">     462 </span><span class="lineCov">          6 :                                 TargetNames[tld_index], tld_entry-&gt;count, count_per_string[tld_index + 1]);</span>
<span class="lineNum">     463 </span><span class="lineCov">          6 :                             if ((int)tld_entry-&gt;count &gt; count_per_string[tld_index + 1]) {</span>
<span class="lineNum">     464 </span><span class="lineNoCov">          0 :                                 ret = false;</span>
<span class="lineNum">     465 </span>            :                             }
<span class="lineNum">     466 </span>            :                         }
<span class="lineNum">     467 </span>            :                     }
<span class="lineNum">     468 </span>            : 
<span class="lineNum">     469 </span><span class="lineCov">      65536 :                     lines[vector_index] = tld_entry;</span>
<span class="lineNum">     470 </span><span class="lineCov">      65536 :                     vector_index++;</span>
<span class="lineNum">     471 </span><span class="lineCov">      65536 :                     tld_entry = tld_entry-&gt;HashNext;</span>
<span class="lineNum">     472 </span>            :                 }
<span class="lineNum">     473 </span>            :             }
<span class="lineNum">     474 </span>            : 
<span class="lineNum">     475 </span><span class="lineCov">          2 :             std::sort(lines.begin(), lines.end(), TldAsKey::CompareTldEntries);</span>
<span class="lineNum">     476 </span>            : 
<span class="lineNum">     477 </span>            :             /* Retain the N most interesting values */
<span class="lineNum">     478 </span><span class="lineCov">      65538 :             for (size_t i = 0; i &lt; lines.size(); i++)</span>
<span class="lineNum">     479 </span>            :             {
<span class="lineNum">     480 </span><span class="lineCov">      65536 :                 if (export_count &lt; max_tld_leakage_count)</span>
<span class="lineNum">     481 </span>            :                 {
<span class="lineNum">     482 </span><span class="lineCov">        256 :                     kept_keys += lines[i]-&gt;count;</span>
<span class="lineNum">     483 </span><span class="lineCov">        256 :                     export_count++;</span>
<span class="lineNum">     484 </span><span class="lineCov">        256 :                     int tld_index = GetTldIndex(lines[i]-&gt;tld, lines[i]-&gt;tld_len);</span>
<span class="lineNum">     485 </span><span class="lineCov">        256 :                     DnsHashEntry key;</span>
<span class="lineNum">     486 </span><span class="lineCov">        256 :                     bool stored = false;</span>
<span class="lineNum">     487 </span>            : 
<span class="lineNum">     488 </span><span class="lineCov">        256 :                     key.count = lines[i]-&gt;count;</span>
<span class="lineNum">     489 </span><span class="lineCov">        256 :                     key.registry_id = REGISTRY_DNS_Frequent_TLD_Usage;</span>
<span class="lineNum">     490 </span><span class="lineCov">        256 :                     key.key_length = lines[i]-&gt;tld_len;</span>
<span class="lineNum">     491 </span><span class="lineCov">        256 :                     key.key_type = 1; /* string */</span>
<span class="lineNum">     492 </span><span class="lineCov">        256 :                     memcpy(key.key_value, lines[i]-&gt;tld, lines[i]-&gt;tld_len);</span>
<span class="lineNum">     493 </span><span class="lineCov">        256 :                     key.key_value[lines[i]-&gt;tld_len] = 0;</span>
<span class="lineNum">     494 </span>            : 
<span class="lineNum">     495 </span><span class="lineCov">        256 :                     (void)hashTable.InsertOrAdd(&amp;key, true, &amp;stored);</span>
<span class="lineNum">     496 </span>            : 
<span class="lineNum">     497 </span><span class="lineCov">        256 :                     if (tld_index &lt; 0) {</span>
<span class="lineNum">     498 </span><span class="lineCov">        228 :                         if (lines[i]-&gt;count &gt; 1) {</span>
<span class="lineNum">     499 </span>            :                             TEST_LOG(&quot;rank %d, random name, length %d, count %d\n&quot;,
<span class="lineNum">     500 </span><span class="lineNoCov">          0 :                                 i, lines[i]-&gt;tld_len, lines[i]-&gt;count);</span>
<span class="lineNum">     501 </span>            :                         }
<span class="lineNum">     502 </span>            :                     } else {
<span class="lineNum">     503 </span><span class="lineCov">         28 :                         if (count_per_string[tld_index + 1] != (int)lines[i]-&gt;count) {</span>
<span class="lineNum">     504 </span>            :                             TEST_LOG(&quot;rank %d, %s, count %d instead of %d\n&quot;,
<span class="lineNum">     505 </span><span class="lineCov">          6 :                                 i, TargetNames[tld_index], lines[i]-&gt;count, count_per_string[tld_index + 1]);</span>
<span class="lineNum">     506 </span><span class="lineCov">          6 :                             if ((int)lines[i]-&gt;count &gt; count_per_string[tld_index + 1]) {</span>
<span class="lineNum">     507 </span><span class="lineNoCov">          0 :                                 ret = false;</span>
<span class="lineNum">     508 </span>            :                             }
<span class="lineNum">     509 </span>            :                         }
<span class="lineNum">     510 </span><span class="lineCov">        256 :                     }</span>
<span class="lineNum">     511 </span>            :                 }
<span class="lineNum">     512 </span>            :                 else
<span class="lineNum">     513 </span>            :                 {
<span class="lineNum">     514 </span><span class="lineCov">      65280 :                     dropped_keys += lines[i]-&gt;count;</span>
<span class="lineNum">     515 </span>            :                 }
<span class="lineNum">     516 </span><span class="lineCov">          2 :             }</span>
<span class="lineNum">     517 </span>            :         }
<span class="lineNum">     518 </span>            : 
<span class="lineNum">     519 </span>            :         /* Verify count */
<span class="lineNum">     520 </span><span class="lineCov">          2 :         ret &amp;= ((kept_keys + dropped_keys) == total_keys);</span>
<span class="lineNum">     521 </span>            : 
<span class="lineNum">     522 </span><span class="lineCov">          2 :         if (!ret) {</span>
<span class="lineNum">     523 </span>            :             TEST_LOG(&quot;Tld count test, kept_keys + dropped_keys: %d + %d = %d != total: %d\n&quot;,
<span class="lineNum">     524 </span><span class="lineNoCov">          0 :                 kept_keys, dropped_keys, kept_keys + dropped_keys, total_keys);</span>
<span class="lineNum">     525 </span>            :         } else {
<span class="lineNum">     526 </span><span class="lineCov">          2 :             int delta_count = expected_count - kept_keys;</span>
<span class="lineNum">     527 </span>            : 
<span class="lineNum">     528 </span><span class="lineCov">          2 :             ret = (delta_count &lt;= max_delta_count) &amp;&amp; (-delta_count &lt;= max_delta_count);</span>
<span class="lineNum">     529 </span><span class="lineCov">          2 :             if (!ret) {</span>
<span class="lineNum">     530 </span>            :                 TEST_LOG(&quot;Tld count test, expected_count: %d &gt;&gt; kept_keys: %d\n&quot;,
<span class="lineNum">     531 </span><span class="lineNoCov">          0 :                     expected_count, kept_keys);</span>
<span class="lineNum">     532 </span>            :             }
<span class="lineNum">     533 </span>            :         }
<span class="lineNum">     534 </span>            : 
<span class="lineNum">     535 </span><span class="lineCov">          2 :         if (ret){</span>
<span class="lineNum">     536 </span>            :             /* Verify the values from the hash table */
<span class="lineNum">     537 </span>            :             DnsHashEntry *entry;
<span class="lineNum">     538 </span>            : 
<span class="lineNum">     539 </span><span class="lineCov">       1026 :             for (uint32_t i = 0; i &lt; hashTable.GetSize(); i++)</span>
<span class="lineNum">     540 </span>            :             {
<span class="lineNum">     541 </span><span class="lineCov">       1024 :                 entry = hashTable.GetEntry(i);</span>
<span class="lineNum">     542 </span>            : 
<span class="lineNum">     543 </span><span class="lineCov">       2410 :                 while (entry != NULL)</span>
<span class="lineNum">     544 </span>            :                 {
<span class="lineNum">     545 </span><span class="lineCov">        362 :                     if (entry-&gt;registry_id == REGISTRY_DNS_Frequent_TLD_Usage) {</span>
<span class="lineNum">     546 </span><span class="lineCov">        256 :                         hashed_count += entry-&gt;count;</span>
<span class="lineNum">     547 </span>            :                     }
<span class="lineNum">     548 </span><span class="lineCov">        106 :                     else if (entry-&gt;registry_id == REGISTRY_DNS_TLD_Usage_Count) {</span>
<span class="lineNum">     549 </span><span class="lineCov">          4 :                         hashed_total = entry-&gt;count;</span>
<span class="lineNum">     550 </span>            :                     }
<span class="lineNum">     551 </span>            : 
<span class="lineNum">     552 </span><span class="lineCov">        362 :                     entry = entry-&gt;HashNext;</span>
<span class="lineNum">     553 </span>            :                 }
<span class="lineNum">     554 </span>            :             }
<span class="lineNum">     555 </span>            : 
<span class="lineNum">     556 </span><span class="lineCov">          2 :             if (hashed_count != kept_keys) {</span>
<span class="lineNum">     557 </span>            :                 TEST_LOG(&quot;Tld sum count after hash: %d  != kept_keys: %d\n&quot;,
<span class="lineNum">     558 </span><span class="lineNoCov">          0 :                     hashed_count, kept_keys);</span>
<span class="lineNum">     559 </span><span class="lineNoCov">          0 :                 ret = false;</span>
<span class="lineNum">     560 </span><span class="lineCov">          2 :             } else if (hashed_total != total_keys) {</span>
<span class="lineNum">     561 </span>            :                 TEST_LOG(&quot;Tld total from hash: %d  != total_keys: %d\n&quot;,
<span class="lineNum">     562 </span><span class="lineNoCov">          0 :                     hashed_total, total_keys);</span>
<span class="lineNum">     563 </span><span class="lineNoCov">          0 :                 ret = false;</span>
<span class="lineNum">     564 </span>            :             }
<span class="lineNum">     565 </span>            :         }
<span class="lineNum">     566 </span>            :     }
<span class="lineNum">     567 </span><span class="lineCov">          4 :     return ret;</span>
<a name="568"><span class="lineNum">     568 </span>            : }</a>
<span class="lineNum">     569 </span>            : 
<span class="lineNum">     570 </span><span class="lineCov">      65792 : int TldCountTest::GetTldIndex(uint8_t * tld, size_t tld_len)</span>
<span class="lineNum">     571 </span>            : {
<span class="lineNum">     572 </span><span class="lineCov">      65792 :     int low = -1;</span>
<span class="lineNum">     573 </span><span class="lineCov">      65792 :     int high = nbTargetNames;</span>
<span class="lineNum">     574 </span>            :     int middle;
<span class="lineNum">     575 </span><span class="lineCov">      65792 :     int found = -1;</span>
<span class="lineNum">     576 </span>            : 
<span class="lineNum">     577 </span><span class="lineCov">     832914 :     while (found == -1 &amp;&amp; low &lt; high) {</span>
<span class="lineNum">     578 </span>            :         uint8_t * r;
<span class="lineNum">     579 </span>            :         size_t r_len;
<span class="lineNum">     580 </span><span class="lineCov">     766800 :         int cmp = 0;</span>
<span class="lineNum">     581 </span>            : 
<span class="lineNum">     582 </span><span class="lineCov">     766800 :         middle = low + (high - low) / 2;</span>
<span class="lineNum">     583 </span>            : 
<span class="lineNum">     584 </span><span class="lineCov">     766800 :         if (middle == low || middle == high) {</span>
<span class="lineNum">     585 </span>            :             break;
<span class="lineNum">     586 </span>            :         }
<span class="lineNum">     587 </span>            : 
<span class="lineNum">     588 </span><span class="lineCov">     701330 :         r = (uint8_t *) TargetNames[middle];</span>
<span class="lineNum">     589 </span><span class="lineCov">     701330 :         r_len = strlen(TargetNames[middle]);</span>
<span class="lineNum">     590 </span>            : 
<span class="lineNum">     591 </span>            : 
<span class="lineNum">     592 </span><span class="lineCov">    1867388 :         for (size_t i = 0; cmp == 0 &amp;&amp;  i &lt; tld_len; i++) {</span>
<span class="lineNum">     593 </span><span class="lineCov">    1166058 :             if (i &gt; r_len || tld[i] &gt; r[i]) {</span>
<span class="lineNum">     594 </span><span class="lineCov">     382772 :                 cmp = 1; /* Tld is below middle */</span>
<span class="lineNum">     595 </span>            :             }
<span class="lineNum">     596 </span><span class="lineCov">     783286 :             else if (tld[i] &lt; r[i]) {</span>
<span class="lineNum">     597 </span><span class="lineCov">     318188 :                 cmp = -1; /* Tld is above middle */</span>
<span class="lineNum">     598 </span>            :             }
<span class="lineNum">     599 </span>            :         }
<span class="lineNum">     600 </span><span class="lineCov">     701330 :         if (cmp == 0 &amp;&amp; r_len &gt; tld_len) {</span>
<span class="lineNum">     601 </span><span class="lineCov">         48 :             cmp = -1; /* name is longer, tld is below it  */</span>
<span class="lineNum">     602 </span>            :         }
<span class="lineNum">     603 </span>            : 
<span class="lineNum">     604 </span><span class="lineCov">     701330 :         switch (cmp) {</span>
<span class="lineNum">     605 </span>            :         case -1:
<span class="lineNum">     606 </span><span class="lineCov">     318236 :             high = middle;</span>
<span class="lineNum">     607 </span><span class="lineCov">     318236 :             break;</span>
<span class="lineNum">     608 </span>            :         case 0:
<span class="lineNum">     609 </span><span class="lineCov">        322 :             found = middle;</span>
<span class="lineNum">     610 </span><span class="lineCov">        322 :             break;</span>
<span class="lineNum">     611 </span>            :         case 1:
<span class="lineNum">     612 </span><span class="lineCov">     382772 :             low = middle;</span>
<span class="lineNum">     613 </span><span class="lineCov">     382772 :             break;</span>
<span class="lineNum">     614 </span>            :         }
<span class="lineNum">     615 </span>            :     }
<span class="lineNum">     616 </span>            : 
<span class="lineNum">     617 </span><span class="lineCov">      65792 :     return found;</span>
<span class="lineNum">     618 </span>            : }
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.10</a></td></tr>
  </table>
  <br>

</body>
</html>
